# Introduction
This repository publishs the source codes used in the paper "Topological Measurement of Deep Neural Networks Using Persistent Homology." It includes four Python notebooks. 
* makeModelMNIST.ipynb
* makeModelCIFAR10.ipynb
* makeSimplex.ipynb
* drawDiagram.ipynb

### makeModelMNIST.ipynb, makeModelCIFAR10.ipynb
These notebooks make traind models on the MNIST and CIFAR10 data sets. 
The models are stored in the "models" directory.

### makeSimplex.ipynb
This notebook constructs simplexes on trained models stored in "models" directory. 
The results are stored in "simplexes" directory.

### drawDiagram.ipynb
This notebook draws persistent homology diagrams using Dionysus library based on the files generated by the notebook "makeSimplex.ipynb."

# Usage
The notebooks are developed for the execution in Google Colaboratory. 
They mounts gdrive in their first cells, comment them out if unnecessary.

### Paramenters in makeModelMNIST.ipynb and makeModelCIFAR10.ipynb
They have four parameters for specifing the input data and network structures.
* class_list = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
* firstLayerSize = 300
* secondLayerSize = 100
* outputNeuron = 10

"class_list" limits the input class in the data sets.
For example, class_list = [0, 1, 2, 3, 4] limits the input data to the five classes.
"firstLayerSize", "secondLayerSize", and "outputNeuron" specifies the number of neurons in the models.

### Paramenters in makeSimplex.ipynb
This notebook has seven parameters for specifing the weight parameter in the training models.
It inputs the target model from the "models" directory.
* layerNumber
* layerNumber1
* layerNumber2
* firstLayerSize
* secondLayerSize
* outputNeuron
* class_list

(0, 1, 2) and (9, 11, 12) are used for (layerNumber, LayerNumber1, layerNumber2) in the MNIST and CIFAR-10 data set, respectively.
"firstLayerSize", "secondLayerSize", "outputNeuron", and "class_list" are to be set same as the parameters set in makeModelMNIST.ipynb or makeModelCIFAR10.ipynb.

### Paramenters in drawDiagram.ipynb
This notebook inputs 64 files generated by "makeSimplex.ipynb" from "simplexes" directory, which is a parameter of this notebook.

# Sample execution
Sample data enable drawDiagram.ipynb work without other notebooks.
### drawDiagram.ipynb
"simplexes/sample" directry has 64 files generated by makeSimplex.ipynb.
A persistent homology diagram is drawn if the parameter is changed to "simplexes/sample" in drawDiagram.ipynb.

### makeSimplex.ipynb
"models" directory has sample models generated by makeModelMNIST.ipynb and makeModelCIFAR10.ipynb.
Sample execution is possible by specifing them in the "model_name" parameter in makeSimplex.ipynb.

